---
title: "Association of Eating Habits and Physical Conditions with Obesity Levels from Mexico, Peru, and Colombia"
subtitle: "Multivariate Analysis // Fall 2021 // Hunter College"
author: "Reina Li"
output:
  github_document:
    toc: true
---

--------------------------------------------------------------------------------

# Introduction

Obesity is a common yet serious disease that affects overall health, health care costs, and productivity, and can lead to a higher risk of developing other serious health complications such as type 2 diabetes, heart disease, and some cancers.

The obesity epidemic is relatively new in South America. According to the Global Nutrition Report, the average prevalence of obesity in adult women and men (aged 18 and over) in South America is 29.0% and 21.9%, respectively. The shifts in less healthy diets, and changes in the food system (increase in fast food and highly processed foods; and excessive sugar, sodium, and fat) makes the population more susceptible to obesity.

This data set obtained from University of California, Irvine, Machine Learning Repository includes data for the estimation of obesity levels in individuals from ages 14 to 61 from the countries of Mexico, Peru, and Colombia, based on their eating habits and physical conditions.

Data was collected through an anonymous survey.

The questions of the survey used for initial recollection of information are presented below:

1. What is your gender?
- Female
- Male

2. What is your age?
- Numeric value

3. What is your height?
- Numeric value in meters

4. What is your weight?
- Numeric value in kilograms

5. Has a family member suffered or suffers from overweight?
- No
- Yes

6. Do you eat high caloric food frequently?
- No
- Yes

7. Do you usually eat vegetables in your meals?
- Always
- Sometimes
- Never

8. How many main meals do you have daily?
- Between 1 and 2
- Three
- More than three

9. Do you eat any food between meals?
- No
- Sometimes
- Frequently
- Always

10. Do you smoke?
- No
- Yes

11. How much water do you drink daily?
- Less than a liter
- Between 1 and 2 L
- More than 2 L

12. Do you monitor the calories you eat daily?
- Yes
- No

13. How often do you have physical activity?
- I do not have
- 1 or 2 days
- 2 or 4 days
- 4 or 5 days

14. How much time do you use technological devices such as cell phone, videogames, television, computer, and others?
- 0-2 hours
- 3-5 hours
- More than 5 hours

15. How often do you drink alcohol?
- I do not drink
- Sometimes
- Frequently
- Always

16. Which transportation do you usually use?
- Bike
- Walking
- Public Transportation
- Automobile
- Motorbike

The data set contains 17 attributes, relating to eating habits: Frequent consumption of high caloric food, Frequency of consumption of vegetables, Number of main meals, Consumption of food between meals, Consumption of water daily, and Consumption of alcohol; and relating to physical conditions: Calories consumption monitoring, Physical activity frequency, Time using technology devices, Transportation used; and other variables: Gender, Age, Height, and Weight.

After the survey responses were collected and preprocessed, the data was labeled with the class variable Obesity Level with values of: (1) Insufficient Weight, (2) Normal Weight, (3) Overweight Level I, (4) Overweight Level II, (5) Obesity Type I, (6) Obesity Type II, and (7) Obesity Type III, which is calculated using the body mass index (BMI) equation, 

$$
BMI = \frac{weight}{height*height}
$$

and information from World Health Organization (WHO) and Mexican Normativity:

-	Insufficient Weight: Less than 18.5
-	Normal Weight: 18.5 to 24.9
-	Overweight Level I: 25.0 to 27.4
-	Overweight Level II: 27.5 to 29.9
-	Obesity Type I: 30.0 to 34.9
-	Obesity Type II: 35.0 to 39.9
-	Obesity Type III: Higher than 40

After the data was labeled, it was found that there was an unbalanced distribution of data regarding the obesity levels category. So, 1626 data responses were generated using the tool Weka, and a filter that required to indicate the class for generation of synthetic data, the number of nearest neighbors used, the percentage needed to increase the selected class, and the random seed used for random sampling. This balancing process brought the total amount of responses from 485 to 2111. The difference of balance of categories of obesity levels before and after can be seen in the plots below.

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
library("readxl")
library("ggplot2")
library("dplyr")
library("GGally")
library("here")
library("ggfortify")
library("matlib")
library("psych")
library("MVA")
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# load in data

# raw data
rawObesity <- read_excel("ObesityData_Raw.xlsx")

# raw + generated data
beforeObesity <- read_excel("ObesityData_RawGenerated.xlsx")

# rename columns
colnames(rawObesity) <- c("Gender", "Age", "Height", "Weight", 
                          "Family_History_With_Overweight", "High_Caloric_Food", 
                          "Vegetables", "Daily_Main_Meals", 
                          "Food_Between_Meals", "Smoke", "Water", 
                          "Monitor_Calories", "Physical_Activity", 
                          "Technological_Devices", "Alcohol", "Transportation", 
                          "Obesity_Level")
colnames(beforeObesity) <- c("Gender", "Age", "Height", "Weight", 
                             "Family_History_With_Overweight", 
                             "High_Caloric_Food", "Vegetables", 
                             "Daily_Main_Meals", "Food_Between_Meals", "Smoke", 
                             "Water", "Monitor_Calories", "Physical_Activity", 
                             "Technological_Devices", "Alcohol", 
                             "Transportation", "Obesity_Level")
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# make histogram of raw data set

# Gender
a1 <- ggplot(as.data.frame(table(rawObesity$Gender)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a1 + ggtitle("What is your gender? (raw data)")

# Family History with Overweight
a2 <- ggplot(as.data.frame(table(rawObesity$Family_History_With_Overweight)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a2 + ggtitle("Has a family member suffered or suffers from overweight? (raw data)")

# High Caloric Food
a3 <- ggplot(as.data.frame(table(rawObesity$High_Caloric_Food)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a3 + ggtitle("Do you eat high caloric food frequently? (raw data)")

# Vegetables
data0 <- as.data.frame(table(rawObesity$Vegetables))
data0$Var1 <- factor(data0$Var1, levels = c("Never", "Sometimes", "Always"))
a4 <- ggplot(data0, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a4 + ggtitle("Do you usually eat vegetables in your meals? (raw data)")

# Daily Main Meals
daily_main_meals <- rawObesity$Daily_Main_Meals
Var1 <- c("Less than 3", "3", "More than 3")
Freq <- c(length(daily_main_meals[daily_main_meals < 3]), 
          length(daily_main_meals[daily_main_meals == 3]), 
          length(daily_main_meals[daily_main_meals > 3]))
data1 <- data.frame(Var1, Freq)
data1$Var1 <- factor(data1$Var1, levels = c("Less than 3", "3", "More than 3"))
a5 <- ggplot(data1, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a5 + ggtitle("How many main meals do you have daily? (raw data)")

# Food Between Meals
data2 <- as.data.frame(table(rawObesity$Food_Between_Meals))
data2$Var1 <- factor(data2$Var1, levels = c("no", "Sometimes", "Frequently", 
                                            "Always"))
a6 <- ggplot(data2, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a6 + ggtitle("Do you eat any food between meals? (raw data)")

# Smoke
a7 <- ggplot(as.data.frame(table(rawObesity$Smoke)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a7 + ggtitle("Do you smoke? (raw data)")

# Water
water <- rawObesity$Water
Var1 <- c("Less than a liter", "Between 1 and 2 L", "More than 2 L")
Freq <- c(length(water[water < 2]), length(water[water == 2]), 
          length(water[water > 2]))
data3 <- data.frame(Var1, Freq)
data3$Var1 <- factor(data3$Var1, 
                     levels = c("Less than a liter", "Between 1 and 2 L", 
                                "More than 2 L"))
a8 <- ggplot(data3, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a8 + ggtitle("How much water do you drink daily? (raw data)")

# Monitor Calories
data4 <- as.data.frame(table(rawObesity$Monitor_Calories))
data4$Var1 <- factor(data4$Var1, levels = c("yes", "no"))
a9 <- ggplot(data4, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a9 + ggtitle("Do you monitor the calories you eat daily? (raw data)")

# Physical Activity
physical <- rawObesity$Physical_Activity
Var1 <- c("I do not have", "1 or 2 days", "2 or 4 days", "4 or 5 days")
Freq <- c(length(physical[physical == 0]), 
          length(physical[physical >= 1 & physical < 2]), 
          length(physical[physical >= 2 & physical < 3]), 
          length(physical[physical >= 3 & physical < 4]))
data5 <- data.frame(Var1, Freq)
data5$Var1 <- factor(data5$Var1, 
                     levels = c("I do not have", "1 or 2 days", "2 or 4 days", 
                                "4 or 5 days"))
a10 <- ggplot(data5, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a10 + ggtitle("How often do you have physical activity? (raw data)")

# Technological Devices
tech <- rawObesity$Technological_Devices
Var1 <- c("0-2 hours", "3-5 hours", "More than 5 hours")
Freq <- c(length(tech[tech < 1]), 
          length(tech[tech >= 1 & tech < 2]), length(tech[tech >= 2]))
data6 <- data.frame(Var1, Freq)
data6$Var1 <- factor(data6$Var1, 
                     levels = c("0-2 hours", "3-5 hours", "More than 5 hours"))
a11 <- ggplot(data6, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a11 + ggtitle("How much time do you use technological devices such as cell phone, 
              videogames, television, computer, and others? (raw data)")

# Alcohol
data7 <- as.data.frame(table(rawObesity$Alcohol))
data7$Var1 <- factor(data7$Var1, levels = c("no", "Sometimes", "Frequently", 
                                            "Always"))
a12 <- ggplot(data7, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a12 + ggtitle("How often do you drink alcohol? (raw data)")

# Transportation
data8 <- as.data.frame(table(rawObesity$Transportation))
data8$Var1 <- factor(data8$Var1, levels = c("Bike", "Walking", 
                                            "Public_Transportation", 
                                            "Automobile", "Motorbike"))
a13 <- ggplot(data8, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a13 + ggtitle("Which transportation do you usually use? (raw data)")

# Obesity Level
data9 <- as.data.frame(table(rawObesity$Obesity_Level))
data9$Var1 <- factor(data9$Var1, 
                     levels = c("Insufficient_Weight", "Normal_Weight", 
                                "Overweight_Level_I", "Overweight_Level_II", 
                                "Obesity_Type_I", "Obesity_Type_II", 
                                "Obesity_Type_III"))
a14 <- ggplot(data9, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
a14 + ggtitle("Obesity Level (raw data)")
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# create density plots of raw data set

# age
c1 <- rawObesity %>%
  ggplot(aes(x = Age)) + geom_density()
c1 + ggtitle("What is your age? (raw data)")

# height
c2 <- rawObesity %>%
  ggplot(aes(x = Height)) + geom_density()
c2 + ggtitle("What is your height? (raw data)")

# weight
c3 <- rawObesity %>%
  ggplot(aes(x = Weight)) + geom_density()
c3 + ggtitle("What is your weight? (raw data)")
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# make histograms of the entire data set (raw + generated values)

# Gender
b1 <- ggplot(as.data.frame(table(beforeObesity$Gender)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b1 + ggtitle("What is your gender? (raw + generated data)")

# Family History with Overweight
b2 <- ggplot(as.data.frame(table(beforeObesity$Family_History_With_Overweight)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b2 + ggtitle("Has a member suffered or suffers from overweight? (raw + generated data)")

# High Caloric Food
b3 <- ggplot(as.data.frame(table(beforeObesity$High_Caloric_Food)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b3 + ggtitle("Do you eat high caloric food frequently? (raw + generated data)")

# Vegetables
veggie <- beforeObesity$Daily_Main_Meals
Var1 <- c("Never", "Sometimes", "Always")
Freq <- c(length(veggie[veggie < 2]), 
          length(veggie[veggie >= 2 & veggie < 3]), 
          length(veggie[veggie >= 3]))
data10 <- data.frame(Var1, Freq)
data10$Var1 <- factor(data10$Var1, 
                      levels = c("Never", "Sometimes", "Always"))
b4 <- ggplot(data10, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b4 + ggtitle("Do you usually eat vegetables in your meals? (raw + generated data)")

# Daily Main Meals
daily_main_meals <- beforeObesity$Daily_Main_Meals
Var1 <- c("Less than 3", "3", "More than 3")
Freq <- c(length(daily_main_meals[daily_main_meals < 3]), 
          length(daily_main_meals[daily_main_meals == 3]), 
          length(daily_main_meals[daily_main_meals > 3]))
data11 <- data.frame(Var1, Freq)
data11$Var1 <- factor(data11$Var1, 
                      levels = c("Less than 3", "3", "More than 3"))
b5 <- ggplot(data11, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b5 + ggtitle("How many main meals do you have daily? (raw + generated data)")

# Food Between Meals
data12 <- as.data.frame(table(beforeObesity$Food_Between_Meals))
data12$Var1 <- factor(data12$Var1, levels = c("no", "Sometimes", "Frequently", 
                                            "Always"))
b6 <- ggplot(data12, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b6 + ggtitle("Do you eat any food between meals? (raw + generated data)")

# Smoke
b7 <- ggplot(as.data.frame(table(beforeObesity$Smoke)), 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b7 + ggtitle("Do you smoke? (raw + generated data)")

# Water
water <- beforeObesity$Water
Var1 <- c("Less than a liter", "Between 1 and 2 L", "More than 2 L")
Freq <- c(length(water[water < 2]), length(water[water == 2]), 
          length(water[water > 2]))
data13 <- data.frame(Var1, Freq)
data13$Var1 <- factor(data13$Var1, 
                      levels = c("Less than a liter", "Between 1 and 2 L", 
                                 "More than 2 L"))
b8 <- ggplot(data13, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b8 + ggtitle("How much water do you drink daily? (raw + generated data)")

# Monitor Calories
data14 <- as.data.frame(table(beforeObesity$Monitor_Calories))
data14$Var1 <- factor(data14$Var1, levels = c("yes", "no"))
b9 <- ggplot(data14, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b9 + ggtitle("Do you monitor the calories you eat daily? (raw + generated data)")

# Physical Activity
physical <- beforeObesity$Physical_Activity
Var1 <- c("I do not have", "1 or 2 days", "2 or 4 days", "4 or 5 days")
Freq <- c(length(physical[physical == 0]), 
          length(physical[physical >= 1 & physical < 2]), 
          length(physical[physical >= 2 & physical < 3]), 
          length(physical[physical >= 3 & physical < 4]))
data15 <- data.frame(Var1, Freq)
data15$Var1 <- factor(data15$Var1, 
                      levels = c("I do not have", "1 or 2 days", "2 or 4 days", 
                                 "4 or 5 days"))
b10 <- ggplot(data15, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b10 + ggtitle("How often do you have physical activity? (raw + generated data)")

# Technological Devices
tech <- beforeObesity$Technological_Devices
Var1 <- c("0-2 hours", "3-5 hours", "More than 5 hours")
Freq <- c(length(tech[tech >= 0 & tech < 1]), 
          length(tech[tech >= 1 & tech < 2]), length(tech[tech >= 2]))
data16 <- data.frame(Var1, Freq)
data16$Var1 <- factor(data16$Var1, 
                      levels = c("0-2 hours", "3-5 hours", "More than 5 hours"))
b11 <- ggplot(data16, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b11 + ggtitle("How much time do you use technological devices such as cell phone, 
              videogames, television, computer, and others? (raw + generated data)")

# Alcohol
data17 <- as.data.frame(table(beforeObesity$Alcohol))
data17$Var1 <- factor(data17$Var1, 
                     levels = c("no", "Sometimes", "Frequently", "Always"))
b12 <- ggplot(data17, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b12 + ggtitle("How often do you drink alcohol? (raw + generated data)")

# Transportation
data18 <- as.data.frame(table(beforeObesity$Transportation))
data18$Var1 <- factor(data18$Var1, 
                     levels = c("Bike", "Walking", "Public_Transportation", 
                                "Automobile", "Motorbike"))
b13 <- ggplot(data18, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b13 + ggtitle("Which transportation do you usually use? (raw + generated data)")

# Obesity Level
data19 <- as.data.frame(table(beforeObesity$Obesity_Level))
data19$Var1 <- factor(data19$Var1, 
                     levels = c("Insufficient_Weight", "Normal_Weight", 
                                "Overweight_Level_I", "Overweight_Level_II", 
                                "Obesity_Type_I", "Obesity_Type_II", 
                                "Obesity_Type_III"))
b14 <- ggplot(data19, 
       aes(x = Var1, y = Freq, fill = Var1)) + geom_bar(stat = "identity") + 
  geom_text(aes(label = Freq), vjust = 0)
b14 + ggtitle("Obesity Level (raw + generated data)")
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# create density plots of the entire data set (raw + generated values)

# age
d1 <- beforeObesity %>%
  ggplot(aes(x = Age)) + geom_density()
d1 + ggtitle("What is your age? (raw + generated data)")

# height
d2 <- beforeObesity %>%
  ggplot(aes(x = Height)) + geom_density()
d2 + ggtitle("What is your height? (raw + generated data)")

# weight
d3 <- beforeObesity %>%
  ggplot(aes(x = Weight)) + geom_density()
d3 + ggtitle("What is your weight? (raw + generated data)")
```

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
a14 + ggtitle("Obesity Level (raw data)")
b14 + ggtitle("Obesity Level (raw + generated data)")
```

Since a large number of people are affected by overweight and obesity globally, it is important to identify which attributes are associated the most with obesity. Using this data set with raw and generated data, the association of the different eating habits and physical conditions with obesity levels will be determined.

# Description of Data

This data set includes 2111 total instances. 23% (485) of the data collected is from survey responses, and the remaining 77% (1626) is generated.

This data set includes 272 instances of one class, 287 instances of another class, 290 instances of another class, 290 instances of another class, 351 instances of another class, 297 instances of another class, and 324 instances of another class. The instances are described by 16 attributes, some of which are either linear, nominal, or ordinal.

There are 16 attributes and the class attribute. The 17 attributes are named by column, in order in the data set: (1) Gender, (2) Age, (3) Height, (4) Weight, (5) family_history_with_overweight, (6) FAVC (frequent consumption of high caloric food), (7) FCVC (frequency of consumption of vegetables), (8) NCP (number of main meals), (9) CAEC (consumption of food between meals), (10) SMOKE, (11) CH2O (consumption of water daily), (12) SCC (calories consumption monitoring), (13) FAF (physical activity frequency), (14) TUE (time using technology devices), (15) CALC (consumption of alcohol), (16) MTRANS (transportation used), and (17) NObeyesdad. NObeyesdad is the class attribute.

The columns were renamed for easier identification, respectively: (1) Gender, (2) Age, (3) Height, (4) Weight, (5) Family_History_With_Overweight, (6) High_Caloric_Food, (7) Vegetables, (8) Daily_Main_Meals, (9) Food_Between_Meals, (10) Smoke, (11) Water, (12) Monitor_Calories, (13) Physical_Activity, (14) Technological_Devices, (15) Alcohol, (16) Transportation, and (17) Obesity_Level.

The following visualizations present the counts or density of the 17 different attributes. Pairs of visualizations are shown for each attribute to visualize the survey data only (raw data) and the survey with generated data (raw + generated data).

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
a1 + ggtitle("What is your gender? (raw data)")
b1 + ggtitle("What is your gender? (raw + generated data)")

c1 + ggtitle("What is your age? (raw data)")
d1 + ggtitle("What is your age? (raw data)")

c2 + ggtitle("What is your height? (raw data)")
d2 + ggtitle("What is your height? (raw + generated data)")

c2 + ggtitle("What is your height? (raw data)")
d3 + ggtitle("What is your weight? (raw + generated data)")

a2 + ggtitle("Has a family member suffered or suffers from overweight? (raw data)")
b2 + ggtitle("Has a family member suffered or suffers from overweight? (raw + generated data)")

a3 + ggtitle("Do you eat high caloric food frequently? (raw data)")
b3 + ggtitle("Do you eat high caloric food frequently? (raw + generated data)")

a4 + ggtitle("Do you usually eat vegetables in your meals? (raw data)")
b4 + ggtitle("Do you usually eat vegetables in your meals? (raw + generated data)")

a5 + ggtitle("How many main meals do you have daily? (raw data)")
b5 + ggtitle("How many main meals do you have daily? (raw + generated data)")

a6 + ggtitle("Do you eat any food between meals? (raw data)")
b6 + ggtitle("Do you eat any food between meals? (raw + generated data)")

a7 + ggtitle("Do you smoke? (raw data)")
b7 + ggtitle("Do you smoke? (raw + generated data)")

a8 + ggtitle("How much water do you drink daily? (raw data)")
b8 + ggtitle("How much water do you drink daily? (raw + generated data)")

a9 + ggtitle("Do you monitor the calories you eat daily? (raw data)")
b9 + ggtitle("Do you monitor the calories you eat daily? (raw + generated data)")

a10 + ggtitle("How often do you have physical activity? (raw data)")
b10 + ggtitle("How often do you have physical activity? (raw + generated data)")

a11 + ggtitle("How much time do you use technological devices such as cell phone, videogames, television, computer, and others? (raw data)")
b11 + ggtitle("How much time do you use technological devices such as cell phone, videogames, television, computer, and others? (raw + generated data)")

a12 + ggtitle("How often do you drink alcohol? (raw data)")
b12 + ggtitle("How often do you drink alcohol? (raw + generated data)")

a13 + ggtitle("Which transportation do you usually use? (raw data)")
b13 + ggtitle("Which transportation do you usually use? (raw + generated data)")
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# data transformation

# Age

count <- 1

while (count != 2112)
{
  if (beforeObesity$Age[count] >= 14 & beforeObesity$Age[count] < 18)
  {
    beforeObesity$Age[count] <- '[14-18)'
    count = count + 1
  }
  else if (beforeObesity$Age[count] >= 18 & beforeObesity$Age[count] < 25)
  {
    beforeObesity$Age[count] <- '[18-25)'
    count = count + 1
  }
  else
  {
    beforeObesity$Age[count] <- '[25-41]'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Height

count <- 1

while (count != 2112)
{
  if (beforeObesity$Height[count] >= 1.4 & beforeObesity$Height[count] < 1.6)
  {
    beforeObesity$Height[count] <- '[1.4-1.6)'
    count = count + 1
  }
  else if (beforeObesity$Height[count] >= 1.6 & beforeObesity$Height[count] < 1.8)
  {
    beforeObesity$Height[count] <- '[1.6-1.8)'
    count = count + 1
  }
  else
  {
    beforeObesity$Height[count] <- '[1.8-2.0)'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Weight

count <- 1

while (count != 2112)
{
  if (beforeObesity$Weight[count] >= 35 & beforeObesity$Weight[count] < 55)
  {
    beforeObesity$Weight[count] <- '[35-55)'
    count = count + 1
  }
  else if (beforeObesity$Weight[count] >= 55 & beforeObesity$Weight[count] < 75)
  {
    beforeObesity$Weight[count] <- '[55-75)'
    count = count + 1
  }
  else if (beforeObesity$Weight[count] >= 75 & beforeObesity$Weight[count] < 95)
  {
    beforeObesity$Weight[count] <- '[75-95)'
    count = count + 1
  }
  else if (beforeObesity$Weight[count] >= 95 & beforeObesity$Weight[count] < 115)
  {
    beforeObesity$Weight[count] <- '[95-115)'
    count = count + 1
  }
  else if (beforeObesity$Weight[count] >= 115 & beforeObesity$Weight[count] < 135)
  {
    beforeObesity$Weight[count] <- '[115-135)'
    count = count + 1
  }
  else if (beforeObesity$Weight[count] >= 135 & beforeObesity$Weight[count] < 155)
  {
    beforeObesity$Weight[count] <- '[135-155)'
    count = count + 1
  }
  else
  {
    beforeObesity$Weight[count] <- '[155-175)'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Vegetables

count <- 1

while (count != 2112)
{
  if (beforeObesity$Vegetables[count] < 2)
  {
    beforeObesity$Vegetables[count] <- 'no'
    count = count + 1
  }
  else
  {
    beforeObesity$Vegetables[count] <- 'yes'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Daily_Main_Meals

count <- 1

while (count != 2112)
{
  if (beforeObesity$Daily_Main_Meals[count] < 3)
  {
    beforeObesity$Daily_Main_Meals[count] <- 'Less_than_three'
    count = count + 1
  }
  else if (beforeObesity$Daily_Main_Meals[count] == 3)
  {
    beforeObesity$Daily_Main_Meals[count] <- 'Three'
    count = count + 1
  }
  else
  {
    beforeObesity$Daily_Main_Meals[count] <- 'More_than_three'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Food_Between_Meals

count <- 1

while (count != 2112)
{
  if (beforeObesity$Food_Between_Meals[count] == 'no')
  {
    beforeObesity$Food_Between_Meals[count] <- 'no'
    count = count + 1
  }
  else
  {
    beforeObesity$Food_Between_Meals[count] <- 'yes'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Water

count <- 1

while (count != 2112)
{
  if (beforeObesity$Water[count] < 2)
  {
    beforeObesity$Water[count] <- 'Less_than_a_liter'
    count = count + 1
  }
  else if (beforeObesity$Water[count] == 2)
  {
    beforeObesity$Water[count] <- 'Between_1_and_2_L'
    count = count + 1
  }
  else
  {
    beforeObesity$Water[count] <- 'More_than_2_L'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Physical_Activity

count <- 1

while (count != 2112)
{
  if (beforeObesity$Physical_Activity[count] == 0)
  {
    beforeObesity$Physical_Activity[count] <- 'none'
    count = count + 1
  }
  else
  {
    beforeObesity$Physical_Activity[count] <- 'yes'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Technological_Devices

count <- 1

while (count != 2112)
{
  if (beforeObesity$Technological_Devices[count] < 1)
  {
    beforeObesity$Technological_Devices[count] <- '[0,3)'
    count = count + 1
  }
  else if (beforeObesity$Technological_Devices[count] >= 1 & 
           beforeObesity$Technological_Devices[count] < 2)
  {
    beforeObesity$Technological_Devices[count] <- '[3-5)'
    count = count + 1
  }
  else
  {
    beforeObesity$Technological_Devices[count] <- 'More_than_5'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Alcohol

count <- 1

while (count != 2112)
{
  if (beforeObesity$Alcohol[count] == 'no')
  {
    beforeObesity$Alcohol[count] <- 'no'
    count = count + 1
  }
  else
  {
    beforeObesity$Alcohol[count] <- 'yes'
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# encode into ordinal integers

input_var <- beforeObesity[,1:16]
target_var <- beforeObesity[17]
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Obesity_Level

count <- 1

while (count != 2112)
{
  if (target_var$Obesity_Level[count] == 'Insufficient_Weight')
  {
    target_var$Obesity_Level[count] <- 0
    count = count + 1
  }
  else if (target_var$Obesity_Level[count] == 'Normal_Weight')
  {
    target_var$Obesity_Level[count] <- 1
    count = count + 1
  }
  else if (target_var$Obesity_Level[count] == 'Overweight_Level_I')
  {
    target_var$Obesity_Level[count] <- 2
    count = count + 1
  }
  else if (target_var$Obesity_Level[count] == 'Overweight_Level_I')
  {
    target_var$Obesity_Level[count] <- 3
    count = count + 1
  }
  else if (target_var$Obesity_Level[count] == 'Obesity_Type_I')
  {
    target_var$Obesity_Level[count] <- 4
    count = count + 1
  }
  else if (target_var$Obesity_Level[count] == 'Obesity_Type_II')
  {
    target_var$Obesity_Level[count] <- 5
    count = count + 1
  }
  else
  {
    target_var$Obesity_Level[count] <- 6
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Gender

count <- 1

while (count != 2112)
{
  if (input_var$Gender[count] == 'Female')
  {
    input_var$Gender[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Gender[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Age

count <- 1

while (count != 2112)
{
  if (input_var$Age[count] == '[14-18)')
  {
    input_var$Age[count] <- 0
    count = count + 1
  }
  else if (input_var$Age[count] == '[18-25)')
  {
    input_var$Age[count] <- 1
    count = count + 1
  }
  else
  {
    input_var$Age[count] <- 2
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Height

count <- 1

while (count != 2112)
{
  if (input_var$Height[count] == '[1.4-1.6)')
  {
    input_var$Height[count] <- 0
    count = count + 1
  }
  else if (input_var$Height[count] == '[1.6-1.8)')
  {
    input_var$Height[count] <- 1
    count = count + 1
  }
  else
  {
    input_var$Height[count] <- 2
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Weight

count <- 1

while (count != 2112)
{
  if (input_var$Weight[count] == '[35-55)')
  {
    input_var$Weight[count] <- 0
    count = count + 1
  }
  else if (input_var$Weight[count] == '[55-75)')
  {
    input_var$Weight[count] <- 1
    count = count + 1
  }
  else if (input_var$Weight[count] == '[75-95)')
  {
    input_var$Weight[count] <- 2
    count = count + 1
  }
  else if (input_var$Weight[count] == '[95-115)')
  {
    input_var$Weight[count] <- 3
    count = count + 1
  }
  else if (input_var$Weight[count] == '[115-135)')
  {
    input_var$Weight[count] <- 4
    count = count + 1
  }
  else if (input_var$Weight[count] == '[135-155)')
  {
    input_var$Weight[count] <- 5
    count = count + 1
  }
  else
  {
    input_var$Weight[count] <- 6
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Family_History_With_Overweight

count <- 1

while (count != 2112)
{
  if (input_var$Family_History_With_Overweight[count] == 'no')
  {
    input_var$Family_History_With_Overweight[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Family_History_With_Overweight[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# High_Caloric_Food

count <- 1

while (count != 2112)
{
  if (input_var$High_Caloric_Food[count] == 'no')
  {
    input_var$High_Caloric_Food[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$High_Caloric_Food[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Vegetables

count <- 1

while (count != 2112)
{
  if (input_var$Vegetables[count] == 'yes')
  {
    input_var$Vegetables[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Vegetables[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Daily_Main_Meals

count <- 1

while (count != 2112)
{
  if (input_var$Daily_Main_Meals[count] == 'Less_than_three')
  {
    input_var$Daily_Main_Meals[count] <- 0
    count = count + 1
  }
  else if (input_var$Daily_Main_Meals[count] == 'Three')
  {
    input_var$Daily_Main_Meals[count] <- 1
    count = count + 1
  }
  else
  {
    input_var$Daily_Main_Meals[count] <- 2
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Food_Between_Meals

count <- 1

while (count != 2112)
{
  if (input_var$Food_Between_Meals[count] == 'no')
  {
    input_var$Food_Between_Meals[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Food_Between_Meals[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Smoke

count <- 1

while (count != 2112)
{
  if (input_var$Smoke[count] == 'no')
  {
    input_var$Smoke[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Smoke[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Water

count <- 1

while (count != 2112)
{
  if (input_var$Water[count] == 'Less_than_a_liter')
  {
    input_var$Water[count] <- 0
    count = count + 1
  }
  if (input_var$Water[count] == 'Between_1_and_2_L')
  {
    input_var$Water[count] <- 1
    count = count + 1
  }
  else
  {
    input_var$Water[count] <- 2
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Monitor_Calories

count <- 1

while (count != 2112)
{
  if (input_var$Monitor_Calories[count] == 'yes')
  {
    input_var$Monitor_Calories[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Monitor_Calories[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Physical_Activity

count <- 1

while (count != 2112)
{
  if (input_var$Physical_Activity[count] == 'yes')
  {
    input_var$Physical_Activity[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Physical_Activity[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Technological_Devices

count <- 1

while (count != 2112)
{
  if (input_var$Technological_Devices[count] == '[0,3)')
  {
    input_var$Technological_Devices[count] <- 0
    count = count + 1
  }
  else if (input_var$Technological_Devices[count] == '[3,5)')
  {
    input_var$Technological_Devices[count] <- 1
    count = count + 1
  }
  else
  {
    input_var$Technological_Devices[count] <- 2
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Alcohol

count <- 1

while (count != 2112)
{
  if (input_var$Alcohol[count] == 'no')
  {
    input_var$Alcohol[count] <- 0
    count = count + 1
  }
  else
  {
    input_var$Alcohol[count] <- 1
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# Transportation

count <- 1

while (count != 2112)
{
  if (input_var$Transportation[count] == 'Bike')
  {
    input_var$Transportation[count] <- 0
    count = count + 1
  }
  else if (input_var$Transportation[count] == 'Walking')
  {
    input_var$Transportation[count] <- 1
    count = count + 1
  }
  else if (input_var$Transportation[count] == 'Public_Transportation')
  {
    input_var$Transportation[count] <- 2
    count = count + 1
  }
  else if (input_var$Transportation[count] == 'Automobile')
  {
    input_var$Transportation[count] <- 3
    count = count + 1
  }
  else
  {
    input_var$Transportation[count] <- 4
    count = count + 1
  }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
encoded_Obesity <- cbind(as.numeric(target_var$Obesity_Level), 
                         as.numeric(input_var$Gender), 
                         as.numeric(input_var$Age),
                         as.numeric(input_var$Height), 
                         as.numeric(input_var$Weight), 
                         as.numeric(input_var$Family_History_With_Overweight), 
                         as.numeric(input_var$High_Caloric_Food), 
                         as.numeric(input_var$Vegetables), 
                         as.numeric(input_var$Daily_Main_Meals), 
                         as.numeric(input_var$Food_Between_Meals), 
                         as.numeric(input_var$Smoke), 
                         as.numeric(input_var$Water), 
                         as.numeric(input_var$Monitor_Calories), 
                         as.numeric(input_var$Physical_Activity), 
                         as.numeric(input_var$Technological_Devices), 
                         as.numeric(input_var$Alcohol), 
                         as.numeric(input_var$Transportation))
```

Some of the considerations made include the uncertainty of the values of Vegetables, Daily_Main_Meals, Water, Physical_Activity, and Technological_Devices.

In the original data set provided by UCI Machine Learning Repository, the Vegetables column contained numerical values from 1 to 3 instead of the provided possible answer: (1) Never, (2) Sometimes, and (3) Always. For the raw data without generated values, it was decided to assign the integer value of 1 to the possible answer Never; the value of 2 to Sometimes; and the value of 3 to Always. However, complications arose because the generated data included double values, or contained decimal values.

In the original data set, the Daily_Main_Meals column contained numerical values from 1 to 4 instead of the provided possible answer: (1) Less than 3, (2) 3, and (3) More than 3. For the raw data without generated values, it was decided to consider the values as the number of daily main meals.

In the original data set, the Water column contained numerical values from 1 to 3 instead of the provided possible answer: (1) Less than a liter, (2) Between 1 and 2 L, and (3) More than 2 L. For the raw data without generated values, it was decided to assign the integer value of 1 to the possible answer Less than a liter; the value of 2 to Between 1 and 2 L; and the value of 3 to More than 2 L. However, complications arose because the generated data included double values, or contained decimal values.

In the original data set provided by UCI Machine Learning Repository, the Physical_Activity column contained numerical values from 0 to 3 instead of the provided possible answer: (1) I do not have, (2) 1 or 2 days, (3) 2 or 4 days, and (4) 4 or 5 days. The cut off was also unclear. For the raw data without generated values, it was decided to assign the integer value of 0 to the possible answer I do not have; the value of 1 to 1 or 2 days; the value of 2 to 2 or 4 days; and the value of 3 to 4 or 5 days. However, complications arose because the generated data included double values, or contained decimal values.

In the original data set provided by UCI Machine Learning Repository, the Technological_Devices column contained numerical values from 0 to 2 instead of the provided possible answer: (1) 0-2 hours, (2) 3-5 hours, and (3) More than 5 hours. An answer for between 2-3 hours was unaccounted for. For the raw data without generated values, it was decided to assign the integer value of 0 to the possible answer 0-2 hours; the value of 1 to 3-5 hours; and the value of 2 to More than 5 hours. However, complications arose because the generated data included double values, or contained decimal values.

Additional considerations made include the evaluation of categorical data from the following columns: (1) Family_History_With_Overweight, (2) High_Caloric_Food, (3) Food_Between_Meals, (4) Smoke, (5) Monitor_Calories, (6) Alcohol, (7) Transportation, and (8) Obesity Level. Many of the variables will need to be encoded in order to do analysis. This will be discussed in the next section.

# Methods and Results

## Data Transformation

This data set contains variables that are nominal categorical variables, ordinal categorical variables, and numerical variables. It is necessary to recode all the values in the data set into before analysis can be performed.

For the Age attribute, the values range from 14 to 61. The values will be separated into different categories: [14-18), [18, 25), [25, 41] based on the three developmental categories: Adolescence, Young adulthood, and Later adulthood.

For the Height attribute, the values range from 1.45 to 1.98. The values will be separated into different categories: [1.4, 1.6), [1.6, 1.8), [1.8, 2.0).

For the Weight attribute, the values range from 39 to 173. The values will be separated into different categories: [35, 55), [55, 75), [75, 95), [95, 115), [115, 135), [135, 155), [155, 175).

Taking into account that the original values of the Vegetables attribute were numerical values ranging from 1 to 3 for Never, Sometimes, Always, respectively, the values will be separated into two categories instead of the original possible answers: yes, no.

For the Daily_Main_Meals attribute, the values will be separated into different categories: Less_than_three, Three, More_than_three.

For the Food_Between_Meals attribute, the values will be separated into two categories instead of the original possible answers: yes, no.

Taking into account that the original values of the Water attribute were numerical values ranging from 1 to 3 for Less than a liter, Between 1 and 2 L, and More than 2, respectively, the values will be separated into the original possible answers: Less_than_a_liter, Between_1_and_2_L, More_than_2_L.

Taking into account that the original values of the Physical_Activity attribute were numerical values ranging from 0 to 3 for I do not have, 1 or 2 days, 2 or 4 days, and 4 or 5 days, respectively, the values will be separated into two categories instead of the original possible answers: none, yes.

Taking into account that the original values of the Technological_Activity attribute were numerical values ranging from 0 to 2 for 0-2 hours, 3-5 hours, and More than 5 hours, respectively, the values will be separated into three categories: [0,3), [3-5), More_than_5.

For the Alcohol attribute, the values will be separated into two categories instead of the original possible answers: yes and no.

As described above, the 17 attributes are converted into categorical variables or quoted strings. The Obesity_Level attribute is then separated into target variable and the other 16 attributes into input variables. Each of the variables are then encoded into ordinal integers. In ordinal or integer encoding, each unique category value is assigned an integer value, and is easily reversible. Ordinal categorical variables have some kind of ordering between its values. The number of variables is unchanged, but all values are ordinal encoded integers. For this data set, the integer values starting at zero are used. Ordinal encoding was used for this data set to retain the order.

## Modeling Technique 1

A principal component analysis of the obesity data was carried out using all of the 16 predictor variables. The target variable, Obesity_Level was not used by PCA and was converted to a string. The covariance matrix, S, and the correlation matrix, R, were calculated for the variables. Eigenvectors and eigenvectors of S and R were calculated separately. R was used for the principal component analysis. The decision to retain how many components was based on the average eigenvalue.

Principal Component Analysis was used because this type of analysis allowed analysis of data sets that contains categorical data. Additionally, the variables originally had different scales. Gaining knowledge of what describes the variation in the data was expected after the analysis. PCA also reduced the number of dimensions by constructing principal components.

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
input_var_numeric <- as.data.frame(sapply(input_var, as.numeric))
des <- describe(input_var_numeric)
knitr::kable(des[,c("min", "max", "mean", "median", "skew", "kurtosis")], 
             main = "Data Summary")
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# carry out a PCA of the data

PCA_Obesity <- encoded_Obesity[,2:17]
Obesity_Level <- beforeObesity$Obesity_Level
PCA_cObesity <- cbind(PCA_Obesity, Obesity_Level)
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# calculating S
ybar <- colMeans(PCA_Obesity)
# covariance matrix S
S <- cov(PCA_Obesity)
# calculate eigenvectors and eigenvalues
eigen_vals <- eigen(S)
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# calculating R
center_scaled_obesity <- scale(PCA_Obesity, center = T, scale = T)
# correlation matrix R
R <- cor(center_scaled_obesity)
# calculate eigenvectors and eigenvalues
eigens <- eigen(R)
```

### Results

The variances of the 16 predictor variables are as follows:

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
diag(S)
```
And the total variance is:

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
sum(diag(S))
```

The eigenvalues of S are as follows:

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
eigen_vals$values
```

And the corresponding eigenvectors are as follows:

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
eigen_vals$vectors
```

The eigenvalues of R are as follows:

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
eigens$values
```

And the corresponding eigenvectors are as follows:

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
eigens$vectors
```

The first two principal components of R are:

$$
z_{1} = -0.239y_{1} - 0.345y_{2} - 0.319y_{3} - 0.492y_{4} - 0.405y_{5} - 0.294y_{6} + 0.050y_{7} + 0.011y_{8} - 0.097y_{9} - 0.017y_{10} - 0.229y_{11} - 0.242y_{12} + 0.023y_{13} + 0.209y_{14} - 0.145y_{15} - 0.186y_{16}
$$

$$
z_{2} = 0.442y_{1} - 0.404y_{2} + 0.493y_{3} - 0.040y_{4} - 0.001y_{5} + 0.032y_{6} + 0.127y_{7} + 0.198y_{8} - 0.112y_{9} + 0.023y_{10} + 0.099y_{11} - 0.013y_{12} - 0.395y_{13} + 0.295y_{14} - 0.055y_{15} - 0.267y_{16}
$$

The largest coefficient in z1, 0.492, corresponds to the largest variance on the diagonal of S. The variances were close in size, which is why the 16 variables entered more evenly into the first two principal components.

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
tibble(eigen_vals = eigen_vals$values) %>%
  mutate(prop_var = eigen_vals/sum(eigen_vals)) %>%
  mutate(cum_prob = cumsum(prop_var))
```

```{r, echo = FALSE, results = TRUE, warning = FALSE, message = FALSE}
tibble(eigen_vals = eigens$values) %>%
  mutate(prop_var = eigen_vals/sum(eigen_vals)) %>%
  mutate(cum_prob = cumsum(prop_var))
```

Looking above to the left, one component of S accounts for 57% of the total variance. Two components account for 67% of the total variance. Seven components account of 91% of the total variance. Looking above to the right, one component of R accounts for 15% of the total variance. Two components account for 26% of the total variance. Thirteen components account for 92% of the total variance.

The decision to retain how many components was based on the average eigenvalue. For S, three values were greater than the average eigenvalue, so three components should be retained. For R, seven values were greater than the average eigenvalue, so seven components should be retained.

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
for (i in 1:16) {
  if (eigen_vals$values[i] > mean(eigen_vals$values)) {
    print(paste(eigen_vals$values[i],"> average eigenvalue, will be retained."))
    }
}
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
for (i in 1:16) {
  if (eigens$values[i] > mean(eigens$values)) {
    print(paste(eigens$values[i],"> average eigenvalue, will be retained."))
    }
}
```

The PCA biplot using S is as follows:

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
pca_res <- prcomp(input_var_numeric, scale. = F)
autoplot(pca_res, data = PCA_cObesity, colour = 'Obesity_Level', loadings = T, 
         loadings.colour = 'blue', loadings.label = T, loadings.label.size = 3) + 
  theme(legend.position = "bottom")
```

And the PCA biplot using R is as follows:

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
pca_res <- prcomp(input_var_numeric, scale. = T)
autoplot(pca_res, data = PCA_cObesity, colour = 'Obesity_Level', loadings = T, 
         loadings.colour = 'blue', loadings.label = T, loadings.label.size = 3) +
  theme(legend.position = "bottom")
```

The vectors begin at the origin and extend to coordinates given by the loading vector. The more parallel to a principal component axis, the more it contributes to only that PC. The longer the vector, the more variability of this variable is being represented by the two displayed principal components. The angles between vectors of different variables show their correlation in this space. Small angles represent high positive correlation. Right angles represent the lack of correlation. Opposite angles represent high negative correlation.

## Modeling Technique 2

An exploratory factor analysis of the obesity data was carried out using a polychoric correlation matrix. Parallel analysis was used to determine the number of factors.

Instead of using a Pearson correlation matrix, a polychoric correlation matrix was used because of the ordinal encoded variables. The polychoric correlation coefficient measures association for ordinal variables. Identification of the underlying relationships between the measured variables was expected after the analysis.

### Results

The computed Pearson and polychoric correlation matrices are visualized below. Positive values are shaded in blue, while negative values are shaded in red. The greater the absolute value of the correlation, the deeper the color.

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
obesity_efa <- cbind(input_var_numeric, Obesity_Level)
# pearson correlation matrix
pear_cor <- cor(input_var_numeric)
cor.plot(pear_cor, numbers = T, upper = F, main = "Pearson Correlation", 
         show.legend = F)
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# exploratory factor analysis

poly_cor <- polychoric(input_var_numeric)
rho <- poly_cor$rho
save(rho, file = "polychoric")

### Thresholds/Scaling results
poly_cor$tau
```

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# polychoric correlation matrix
cor.plot(poly_cor$rho, numbers=T, upper=FALSE, main = "Polychoric Correlation", 
         show.legend = FALSE)
```

The correlation matrices above have very similar patterns, but the polychoric correlation matrix suggests a stronger association.

A parallel analysis was used to determine the number of factors. Parallel analysis is one method to help determine how many factors to retain and is visualized using a scree plot. A scree plot is shown below:

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# scree plot and parallel analysis
load("polychoric")
# Scree plot
fa.parallel(rho, fm = "pa", fa = "fa", main = "Scree Plot")
```

Since parallel analysis is a simulation technique, it may give different results each time. It is necessary to re-run it a few times to get a stable recommendation. The blue line shows the observed eigen values. The red dotted line shows the simulated data line. Each point on the blue line that lies above the red line is a factor to extract. From the scree plot above, parallel analysis suggested that the number of factors to retain was six. So, a factor analysis with six latent factors is performed, with maximum likelihood estimation. 62.8% of variance is explained cumulatively.

**Unrotated**

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
poly_model <- fa(input_var_numeric, nfactors = 6, cor = "poly", fm = "mle", 
                 rotate = "none")
save(poly_model, file = "poly_model")
poly_model$loadings
```

The first factor F1 accounts for 12.6% of total variance. The variables “Age” and “Food_Between_Meals” have high positive loadings on this factor. “Vegetables” has high negative loadings on this factor. “Gender” and “Water” also load negatively on this factor. F3 accounts for 12.2% of total variance. It is primarily defined by “Monitor_Calories”. “Smoke” loads negatively on this factor. F2 accounts for 10.8% of total variance. The variables “Gender”, “Smoke”, and “Height” have high positive loadings on this factor. “Food_Between_Meals” and “Physical_Activity” load negatively on this factor. F5 accounts for 9.2% of total variance. It is primarily defined by “Technological_Devices”. “Age”, “Weight”, “Water”, “Monitor_Calories”, and “Transportation” load negatively on this factor. F6 accounts for 9.1% of total variance. “Family_History_With_Overweight” and “Weight” have high positive loadings on this factor. “Physical_Activity”, “Technological_Devices”, and “Transportation” load negatively on this factor. F4 accounts for 9.0% of total variance. “Age”, “Vegetables”, “Smoke”, “Physical_Activity”, and “Alcohol” load negatively on this factor.

The interpretation of the six factors is visually displayed below, with all loadings with an absolute value greater than 0.3 being represented as an edge.

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
load("poly_model")
# Cluster analysis plot
fa.diagram(poly_model)
```

```{r, fig.width = 15, fig.height = 8, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
obesity_level_numeric <- as.data.frame(sapply(target_var, as.numeric))

load("poly_model")
biplot(poly_model, 
       pch=c(21,21,21,21,21,21,21)[obesity_level_numeric[,"Obesity_Level"]], 
       group = obesity_level_numeric[,"Obesity_Level"], 
       main = "Biplot by obesity level")
```

**Orthogonal Rotation**

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# orthogonal rotation
poly_model2 <- fa(input_var_numeric, nfactors = 6, cor = "poly", fm = "mle", 
                 rotate = "varimax")
save(poly_model2, file = "poly_model")
poly_model2$loadings
```

After a varimax rotation is performed on the data, the rotated factor loadings are calculated. 62.8% of variance is explained cumulatively for orthogonally rotated loadings. “Weight” and “Family_History_With_Overweight” have large positive loadings on F6. “Gender” and “Height” have large positive loadings on F2. “Food_Between_Meals” and “Technological_Devices” have large positive loadings on F5. “Age” has large positive loadings on F3. “Vegetables” has large positive loadings on F1. “Smoke” has large positive loadings on F4. The fact that there are no direct linkages between the factors shows that they are independent of each other.

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
fa.diagram(poly_model2)
```

```{r, fig.width = 15, fig.height = 8, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
biplot(poly_model2, 
       pch=c(21,21,21,21,21,21,21)[obesity_level_numeric[,"Obesity_Level"]], 
       group = obesity_level_numeric[,"Obesity_Level"], 
       main = "Biplot by obesity level")
```

**Oblique Rotation**

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# oblique rotation
poly_model3 <- fa(input_var_numeric, nfactors = 6, cor = "poly", fm = "mle", 
                 rotate = "Promax")
save(poly_model3, file = "poly_model")
poly_model3$loadings
```

After a promax rotation is performed on the data, the rotated factor loadings are calculated. 63.6% of variance is explained cumulatively for oblique rotated loadings. “Weight” and “Family_History_With_Overweight” have large positive loadings on F6. “Gender” and “Height” have large positive loadings on F2. “Food_Between_Meals” and “Technological_Devices” have large positive loadings on F5. “Age” has large positive loadings on F3. “Smoke” has large positive loadings on F4. “Vegetables” has large positive loadings on F1. The direct linkage between F6 and F3 shows that they are dependent of each other.

```{r, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
fa.diagram(poly_model3)
```

```{r, fig.width = 15, fig.height = 8, echo = FALSE, results = FALSE, warning = FALSE, message = FALSE}
biplot(poly_model3, 
       pch=c(21,21,21,21,21,21,21)[obesity_level_numeric[,"Obesity_Level"]], 
       group = obesity_level_numeric[,"Obesity_Level"], 
       main = "Biplot by obesity level")
```

# Discussion

The principal components describe variation and account for the varied influences of the original characteristics. Looking at the PCA biplot using the correlation matrix, “Family_History_With_Overweight”, “Monitor_Calories”, “Weight”, and “High_Caloric_Food” are the most important contributors to the first PC, while “Daily_Main_Meals” and “Physical_Activity” strongly influence PC2. “Monitor_Calories” and “Weight” are highly correlated. “Technological_Devices” and “Physical_Activity” are uncorrelated with most of the other variables.

“Gender”, “Age”, “Weight”, “Family_History_With_Overweight”, “High_Caloric_Food”, “Daily_Main_Meals”, “Monitor_Calories”, and “Technological_Devices” are highly significantly associated to changes in Obesity_Level, while changes in “Vegetables”, “Food_Between_Meals”, “Smoke”, “Water”, “Physical_Activity”, and “Transportation” are not significantly associated with Obesity_Level.

The exploratory factor analysis biplots indicate that the latent factors are not normally distributed. It is necessary to further explore the structure of the data by using a nonlinear factor analysis approach.

Analysis can be improved by encoding the original data set in a different way, for example: one hot encoding, dummy encoding, effect or deviation encoding, hash encoding, binary encoding, base N encoding, and target encoding. A nonlinear factor analysis may help to explore the structure of the data. After my classmates’ presentations, doing different transformations on the data would be considered for further studies.

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
# regression
Obes_Lvl <- as.numeric(target_var$Obesity_Level)
reg_obesity <- cbind(input_var_numeric,Obes_Lvl)
```

```{r, echo = TRUE, include = FALSE, results = FALSE, warning = FALSE, message = FALSE}
fit <- lm(Obes_Lvl ~ Gender + Age + Height + Weight + 
            Family_History_With_Overweight + High_Caloric_Food + Vegetables + 
            Daily_Main_Meals + Food_Between_Meals + Smoke + Water + 
            Monitor_Calories + Physical_Activity + Technological_Devices + 
            Alcohol + Transportation, data = reg_obesity)
summary(fit)
```

# Sources

1. Centers for Disease Control and Prevention. (2021, April 7). About overweight and obesity. Centers for Disease Control and Prevention. Retrieved December 2021, from [https://www.cdc.gov/obesity/about-obesity/index.html.](https://www.cdc.gov/obesity/about-obesity/index.html)
2. South America. Global Nutrition Report | Country Nutrition Profiles - Global Nutrition Report. (n.d.). Retrieved December 2021, from [https://globalnutritionreport.org/resources/nutrition-profiles/latin-america-and-caribbean/south-america/.](https://globalnutritionreport.org/resources/nutrition-profiles/latin-america-and-caribbean/south-america/)
3. Popkin, B. M., & Reardon, T. (2018). Obesity and the food system transformation in Latin America. Obesity reviews : an official journal of the International Association for the Study of Obesity, 19(8), 1028–1064. [https://doi.org/10.1111/obr.12694.](https://doi.org/10.1111/obr.12694)
4. University of California, Irvine, Machine Learning Repository. [https://archive.ics.uci.edu/ml/datasets/Estimation+of+obesity+levels+based+on+eating+habits+and+physical+condition+.](https://archive.ics.uci.edu/ml/datasets/Estimation+of+obesity+levels+based+on+eating+habits+and+physical+condition+)
5. Mendoza Palechor, F., & de la Hoz Manotas, A. (2019). Dataset for estimation of obesity levels based on eating habits and physical condition in individuals from Colombia, Peru, and Mexico. Data in Brief, 25, [https://doi.org/10.1016/j.dib.2019.104344.](https://doi.org/10.1016/j.dib.2019.104344)
6. MIT. (n.d.). CHANGES IN YOUNG ADULTHOOD. Young Adult Development Project. Retrieved December 2021, from [https://hr.mit.edu/static/worklife/youngadult/changes.html.](https://hr.mit.edu/static/worklife/youngadult/changes.html)
7. Brownlee, J. (2020, August 17). Ordinal and one-hot encodings for Categorical Data. Machine Learning Mastery. Retrieved December 2021, from [https://machinelearningmastery.com/one-hot-encoding-for-categorical-data/.](https://machinelearningmastery.com/one-hot-encoding-for-categorical-data/)
8. Hartmann, K., Krois, J., &amp; Waske, B. (2017, May 1). Interpretation and visualization. Interpretation and Visualization • SOGA •. Retrieved December 2021, from
[https://www.geo.fu-berlin.de/en/v/soga/Geodata-analysis/Principal-Component-Analysis/principal-components-basics/Interpretation-and-visualization/index.html](https://www.geo.fu-berlin.de/en/v/soga/Geodata-analysis/Principal-Component-Analysis/principal-components-basics/Interpretation-and-visualization/index.html)
